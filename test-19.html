<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<script>

    var sum = 897, discounts = [], rest_money;
    //obj[0]: points
    //obj[1]: rate
    //obj[2]: switch
    var points = [[500, 10, 1], [200, 20, 0], [400, 3, 1]];
    for(var i = 0, len = points.length; i < len; i++) {
        var current = points[i];
        var current_discount = parseFloat((current[0] / current[1]).toFixed(2));
        if(current[2]) {
            if(sum > 0) {
                sum -= current_discount;
                if(sum > 0) {
                    discounts.push(current_discount);
                } else {
                    discounts.push(sum + current_discount);
                }
            } else {
                discounts.push(0);
            }
        } else {
            discounts.push(0);
        }
    }
    rest_money = sum < 0 ? 0 : sum;
//    if(sum>0){
//        discounts.push(sum);
//    }
    console.log(rest_money);
    console.log(discounts);
</script>
</body>
</html>